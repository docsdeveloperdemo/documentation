# Docusaurus Redirect Checker Script

A Node.js script that helps you identify URLs in your Docusaurus documentation that don't have corresponding redirects configured. The script checks both `docusaurus.config.js` and `vercel.json` for existing redirects.

## Features

- Checks URLs against both Docusaurus and Vercel redirects
- Smart anchor handling (if a base URL has a redirect, all its anchors are considered covered)
- Configurable exclusions for folders and patterns
- Grouped reporting by base URLs
- Generates ready-to-use redirect configurations

## Prerequisites

- Node.js installed
- A Docusaurus project
- The `all-urls.txt` file generated by the URL extraction script
- Either `docusaurus.config.js` or `vercel.json` (or both) with redirect configurations

## Installation

1. Copy the `check-redirects.js` file into your `scripts` folder, alongside the URL extraction script.

## Configuration

Create a `redirect-config.json` file in your `scripts` folder to customize the script's behavior:

```json
{
    "excludeFolders": [
        "cloud",
        "legacy",
        "internal"
    ],
    "exclude": [
        "/test-",
        "/draft/"
    ]
}
```

### Configuration Options

- `excludeFolders`: Array of folder names to exclude from the analysis
  - URLs starting with these folder names will be ignored
  - Example: `["cloud"]` will exclude "/cloud/doc1", "/cloud/doc2", etc.

- `exclude`: Array of patterns to exclude from the analysis
  - URLs containing these patterns will be ignored
  - Example: `["/test-"]` will exclude "/docs/test-page", "/test-feature", etc.

## Usage

1. Make sure you've run the URL extraction script first:
```bash
node scripts/extract-urls.js
```

2. (Optional) Create and configure `redirect-config.json`

3. Run the redirect checker:
```bash
node scripts/check-redirects.js
```

The script will generate a `redirect-analysis.md` file in your `scripts` folder.

## Understanding the Report

The generated report includes several sections:

### 1. Configuration Overview
Shows which folders and patterns are being excluded from the analysis.

### 2. Summary Statistics
```markdown
## Summary

- Total URLs found: 150
- URLs ignored (based on redirect-config.json): 25
- URLs to process: 125
- Existing redirects in docusaurus.config.js: 45
- Existing redirects in vercel.json: 30
- Base URLs without redirects: 20
- Total URLs without redirects: 75
```

### 3. Missing URLs (Grouped by Base URL)
```markdown
### /docs/api/service
Anchors:
- /docs/api/service#parameters
- /docs/api/service#responses
```

### 4. Configuration Templates
Provides ready-to-use configurations for both Docusaurus and Vercel, including only base URLs (anchors are handled automatically).

## Anchor Handling

The script implements smart anchor handling:
- If a base URL has a redirect (e.g., `/docs/api`), all its anchors (e.g., `/docs/api#usage`, `/docs/api#examples`) are automatically considered covered
- Only base URLs without redirects are reported as missing
- Anchors are grouped under their base URLs in the report for better visibility

## Supported Redirect Formats

### Docusaurus Format
```js
// Object format
{
  from: '/old-path',
  to: '/new-path',
}

// Array format
['/old-path', '/new-path']

// Multiple 'from' paths
{
  from: ['/old-path', '/another-old-path'],
  to: '/new-path',
}
```

### Vercel Format
```json
{
  "redirects": [
    {
      "source": "/old-path",
      "destination": "/new-path",
      "permanent": true
    }
  ]
}
```

## Troubleshooting

If you get any errors, check that:
1. You've run the URL extraction script first
2. Both scripts are in the `scripts/` folder
3. Your configuration files exist and are valid:
   - `docusaurus.config.js` (optional)
   - `vercel.json` (optional)
   - `redirect-config.json` (optional)
4. You're running the script from the root of your Docusaurus project

## Report Output

The generated `redirect-analysis.md` file is:
- Compatible with GitHub/GitLab Markdown viewers
- Easy to convert to other formats (PDF, HTML)
- Structured for easy reading and analysis
- Includes statistics about ignored URLs
- Groups missing URLs by their base URL
- Provides ready-to-use configuration templates